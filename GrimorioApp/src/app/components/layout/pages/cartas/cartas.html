<mat-card class="set-hero" *ngIf="set() as s" [style.--accent]="s.color">
	<div class="hero-bg"></div>

	<div class="hero-left">
		<div class="logo-wrap">
			<img class="set-logo" [src]="s.logo" [alt]="s.nombre" />
		</div>
	</div>

	<div class="hero-right">
		<div class="hero-top">
			<h1 class="set-title">
				{{ s.nombre }}
				<span class="set-code">{{ s.codigo }}</span>
			</h1>

			<div class="status">
				<span class="status-chip" [class.ok]="s.esActivo" [class.nok]="!s.esActivo">
					<mat-icon inline>{{ s.esActivo ? 'check_circle' : 'cancel' }}</mat-icon>
					{{ s.esActivo ? 'Activo' : 'Inactivo' }}
				</span>
			</div>
		</div>

		<div class="hero-meta">
			<div class="meta-item" title="Color del set">
				<span class="color-dot" [style.background]="s.color"></span>
				<span>Color</span>
			</div>

			<div class="meta-item">
				<mat-icon inline>event</mat-icon>
				<span>{{ s.fechaSalida }}</span>
			</div>

			<div class="meta-item">
				<mat-icon inline>collections</mat-icon>
				<span>{{ s.cartas?.length ?? 0 }} cartas</span>
			</div>
		</div>
	</div>
</mat-card>

<!-- Filtros -->
<div class="filters" *ngIf="set()">
	<mat-form-field appearance="outline" class="search-field">
		<mat-label>Buscar</mat-label>
		<input matInput placeholder="Nombre, tipo o rarezaâ€¦" [ngModel]="searchTerm()"
			(ngModelChange)="searchTerm.set($event)" />
		<button mat-icon-button matSuffix aria-label="Clear" *ngIf="searchTerm()" (click)="searchTerm.set('')">
			<mat-icon>close</mat-icon>
		</button>
	</mat-form-field>

	<mat-form-field appearance="outline" class="rareza-field">
		<mat-label>Rareza</mat-label>
		<mat-select [value]="rareza()" (valueChange)="rareza.set($event)">
			<mat-option value="todas">Todas</mat-option>
			<mat-option value="common">Common</mat-option>
			<mat-option value="uncommon">Uncommon</mat-option>
			<mat-option value="rare">Rare</mat-option>
			<mat-option value="mythic">Mythic</mat-option>
		</mat-select>
	</mat-form-field>

	<button mat-flat-button color="primary">
		<mat-icon>add</mat-icon>
		Crear Carta
	</button>
</div>

<!-- Loading -->
<div class="loading" *ngIf="loading()">
	<mat-spinner diameter="40"></mat-spinner>
</div>

<!-- Grid de cartas (6 por fila) -->
<section class="grid" *ngIf="!loading() && filteredCartas().length; else emptyState">
	<a class="card" *ngFor="let c of filteredCartas(); trackBy: trackByCarta" [title]="c.nombre"
		[ngClass]="c.rareza.toLowerCase()" [routerLink]="['/pages/set', idSet, 'carta', c.idCarta]">
		<mat-card class="mat-card-compact">
			<div class="thumb">
				<img [src]="c.imagenUrl" [alt]="c.nombre" loading="lazy" />
			</div>
		</mat-card>
	</a>

</section>

<ng-template #emptyState>
	<div class="empty" *ngIf="!loading()">
		El Set no existe.
	</div>
</ng-template>